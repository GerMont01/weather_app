(this.webpackJsonpweather_app=this.webpackJsonpweather_app||[]).push([[0],{29:function(e,t,n){},30:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),s=n(14),r=n.n(s),i=(n(29),n(30),n(5)),o=n.n(i),u=n(9),d=n(15),l=n(16),h=n(24),j=n(23),p=n(10),b=n(3),m=n(17),f=n.n(m),g=n.p+"static/media/background1.686c9f60.jpg",O=n(1),x=a.a.createContext(),y=function(e,t){switch(t.type){case"ADD_CITY":return e.cities.some((function(e){return e.name===t.payload.name}))||e.cities.push(t.payload),localStorage.setItem("data",JSON.stringify(e)),Object(b.a)({},e);case"DELETE":return e.cities=e.cities.filter((function(e){return e.id!==t.payload})),localStorage.setItem("data",JSON.stringify(e)),Object(b.a)({},e);case"TOGGLE_FORECAST":return Object(b.a)(Object(b.a)({},e),{},{showForecast:t.payload});case"TOGGLE_SIGHTSEEING":return Object(b.a)(Object(b.a)({},e),{},{showSightseeing:t.payload});case"CHANGE_BASE#":var n,c=Object(p.a)(e.cities);try{for(c.s();!(n=c.n()).done;){var a=n.value;a.id===t.payload.id&&(a.base_amount=t.payload.amount)}}catch(s){c.e(s)}finally{c.f()}return Object(b.a)({},e);case"ACTIVE_TAB":return Object(b.a)(Object(b.a)({},e),{},{active:t.payload});case"EMPTY_S":return Object(b.a)(Object(b.a)({},e),{},{sightseeing:[]});case"SET_BASE":return e.handleCurrency(t.payload),Object(b.a)(Object(b.a)({},e),{},{base:t.payload});case"SET_UNIT":return Object(b.a)(Object(b.a)({},e),{},{unit:t.payload});case"TOGGLE_SETTINGS":return Object(b.a)(Object(b.a)({},e),{},{settings:t.payload});default:return Object(b.a)({},e)}},v=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(d.a)(this,n);for(var c=arguments.length,a=new Array(c),s=0;s<c;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={settings:!1,cities:[],unit:"C",units:"metric",forecast:{name:"",country:"",data:[]},sightseeing:[],showForecast:!1,showSightseeing:!1,active:"weather",base:"CAD",fetchForcastAndSightseeing:function(t){e.forecastCity(t),e.getSightseeing(t);var n=e.state;n.showForecast=!0,e.setState(n)},handlefetchData:function(t){e.fetchData(t)},handleCurrency:function(t){var n,c=e.state.cities,a=Object(p.a)(c);try{var s=function(){var a=n.value;e.getCurrency(a.country,t).then((function(t){a.rate=t.rate,e.setState({cities:c}),localStorage.setItem("data",JSON.stringify(e.state))})).catch((function(e){alert("Enter a valid currency code"),console.log("We have some error ".concat(e))}))};for(a.s();!(n=a.n()).done;)s()}catch(r){a.e(r)}finally{a.f()}},dispatch:function(t){e.setState((function(e){return y(e,t)}))}},e}return Object(l.a)(n,[{key:"getSunRise",value:function(e){var t=new Date(1e3*e),n=t.getUTCHours(),c=t.getUTCMinutes();return"".concat(n,":").concat(c)}},{key:"convertDate",value:function(e){var t=(new Date).getTime()/1e3,n=new Date(1e3*(t+e)),c=n.getUTCDate(),a=n.getUTCMonth()+1,s=n.getUTCFullYear();return"".concat(a,"/").concat(c,"/").concat(s)}},{key:"convertTime",value:function(e){var t=(new Date).getTime()/1e3,n=new Date(1e3*(t+e)),c=n.getUTCHours(),a=n.getUTCMinutes();return"".concat(c,":").concat(a)}},{key:"fetchData",value:function(e){var t=this;fetch("https://api.openweathermap.org/data/2.5/weather?q=".concat(e,"&units=").concat(this.state.units,"&appid=bced9de0c38c91650f8270abf3db9fed")).then((function(n){n.json().then((function(n){var c={id:f()(),description:n.weather[0].description.charAt(0).toUpperCase()+n.weather[0].description.slice(1),name:e.charAt(0).toUpperCase()+e.slice(1),country:n.sys.country,temp:Math.round(n.main.temp),temp_min:Math.round(n.main.temp_min),temp_max:Math.round(n.main.temp_max),humidity:n.main.humidity,date:t.convertDate(n.timezone),time:t.convertTime(n.timezone),sunrise:t.getSunRise(n.sys.sunrise+n.timezone),sunset:t.getSunRise(n.sys.sunset+n.timezone),iconurl:"https://openweathermap.org/img/w/".concat(n.weather[0].icon,".png"),base_amount:1,rate:0,code:""};c.name.length>9&&(c.name=c.name.substring(0,9)),t.getCurrency(n.sys.country,t.state.base).then((function(e){c.rate=e.rate,c.code=e.currency_code,t.state.dispatch({type:"ADD_CITY",payload:c})}))})).catch((function(e){console.log("We have some error ".concat(e))}))}))}},{key:"forecastCity",value:function(e){var t=this;fetch("https://api.openweathermap.org/data/2.5/forecast?q=".concat(e,"&units=metric&cnt=8&appid=bced9de0c38c91650f8270abf3db9fed")).then((function(n){n.json().then((function(n){var c={name:e.charAt(0).toUpperCase()+e.slice(1),country:n.city.country,data:[]};c.name.length>9&&(c.name=c.name.substring(0,9));for(var a=0;a<8;a++){var s={description:n.list[a].weather[0].description.charAt(0).toUpperCase()+n.list[a].weather[0].description.slice(1),temp:Math.round(n.list[a].main.temp),humidity:n.list[a].main.humidity,time:n.list[a].dt,timezone:n.city.timezone,iconurl:"https://openweathermap.org/img/w/".concat(n.list[a].weather[0].icon,".png")};c.data.push(s)}t.setState({forecast:c})})).catch((function(e){console.log("We have some error ".concat(e))}))}))}},{key:"getCurrency",value:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var c,a,s,r,i,u,d,l,h,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://restcountries.com/v2/alpha/".concat(t));case 3:return c=e.sent,e.next=6,c.json();case 6:return a=e.sent,e.next=9,a.name;case 9:return s=e.sent,e.next=12,fetch("https://pkgstore.datahub.io/JohnSnowLabs/iso-4217-currency-codes/iso-4217-currency-codes-csv_json/data/248f953387d4218576d846696fc54adf/iso-4217-currency-codes-csv_json.json");case 12:return r=e.sent,e.next=15,r.json();case 15:return i=e.sent,u=i.find((function(e){return!0===e.Entity.toLowerCase().includes(s.toLowerCase())})),d=u.Alphabetic_Code,e.next=20,fetch("https://v6.exchangerate-api.com/v6/e383d57ae359f0928f0da2d2/pair/".concat(n,"/").concat(d));case 20:return l=e.sent,e.next=23,l.json();case 23:if(h=e.sent,!(j=h.conversion_rate)){e.next=27;break}return e.abrupt("return",{currency_code:d,rate:j});case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(0),alert("Enter a valid currency code"),console.log(e.t0);case 33:case"end":return e.stop()}}),e,null,[[0,29]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSightseeing",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,c,a,s,r,i,u,d,l,h,j,p,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="5ae2e3f221c38a28845f05b669931f2de602806c1d15cc8f826b0d32",e.prev=1,e.next=4,fetch("https://api.openweathermap.org/data/2.5/weather?q=".concat(t,"&appid=bced9de0c38c91650f8270abf3db9fed"));case 4:return c=e.sent,e.next=7,c.json();case 7:return a=e.sent,s=a.coord.lon,r=a.coord.lat,e.next=12,fetch("https://api.opentripmap.com/0.1/en/places/radius?radius=2000&lon=".concat(s,"&lat=").concat(r,"&rate=3&limit=5&apikey=").concat(n));case 12:return i=e.sent,e.next=15,i.json();case 15:u=e.sent,d=this.state.sightseeing,l=0;case 18:if(!(l<5)){e.next=30;break}return h=u.features[l].properties.xid,e.next=22,fetch("https://api.opentripmap.com/0.1/en/places/xid/".concat(h,"?apikey=").concat(n));case 22:return j=e.sent,e.next=25,j.json();case 25:(p=e.sent).wikipedia_extracts&&(b={content:p.wikipedia_extracts.html,sight:p.name,image:p.preview.source},d.push(b));case 27:l++,e.next=18;break;case 30:this.setState({sightseeing:d}),e.next=36;break;case 33:e.prev=33,e.t0=e.catch(1),console.log(e.t0);case 36:case"end":return e.stop()}}),e,this,[[1,33]])})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;localStorage.getItem("data")?(JSON.parse(localStorage.getItem("data")).cities.map((function(t){return e.fetchData(t.name)})),this.setState({base:JSON.parse(localStorage.getItem("data")).base})):this.fetchData("vancouver"),localStorage.getItem("background")?document.getElementById("body").style.backgroundImage="url("+localStorage.getItem("background")+")":document.getElementById("body").style.backgroundImage="url(".concat(g,")")}},{key:"render",value:function(){return Object(O.jsx)(x.Provider,{value:this.state,children:this.props.children})}}]),n}(a.a.Component),C=x.Consumer,S=n(4),E=(n(33),n.p+"static/media/close.5e99f6e3.svg");function w(e){var t=Object(c.useState)(e.city),n=Object(S.a)(t,2),a=n[0],s=(n[1],Object(c.useContext)(x));return Object(O.jsxs)("div",{className:"weather",onClick:function(){return s.fetchForcastAndSightseeing(a.name)},children:[Object(O.jsxs)("h2",{children:[a.date," ",a.time]}),Object(O.jsx)("div",{className:"temp",children:"C"===s.unit?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("span",{className:"temp1",children:[a.temp,"\xb0",s.unit]}),Object(O.jsx)("br",{}),Object(O.jsxs)("span",{children:[a.temp_min,"\xb0-",a.temp_max,"\xb0",s.unit]})]}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("span",{className:"temp1",children:[Math.round(9*a.temp/5+32),"\xb0",s.unit]}),Object(O.jsx)("br",{}),Object(O.jsxs)("span",{children:[Math.round(9*a.temp_min/5+32),"\xb0-",Math.round(9*a.temp_max/5+32),"\xb0",s.unit]})]})}),Object(O.jsxs)("div",{className:"desc",children:[Object(O.jsx)("img",{src:a.iconurl}),Object(O.jsx)("span",{children:a.description})]}),Object(O.jsxs)("div",{className:"sun",children:[Object(O.jsx)("i",{className:"fas fa-sun"}),Object(O.jsx)("span",{children:a.sunrise}),Object(O.jsx)("br",{}),Object(O.jsx)("i",{className:"far fa-moon"}),Object(O.jsx)("span",{children:a.sunset})]}),Object(O.jsxs)("div",{className:"humidity",children:[Object(O.jsx)("i",{className:"fas fa-tint"}),Object(O.jsxs)("span",{children:[" ",a.humidity,"%"]})]})]},a.id+"weather")}n(34);function T(e){var t=Object(c.useState)(e.city),n=Object(S.a)(t,2),a=n[0],s=(n[1],Object(c.useState)(1)),r=Object(S.a)(s,2),i=r[0],o=r[1],u=Object(c.useContext)(x);return Object(O.jsxs)("div",{className:"currExchange",children:[Object(O.jsx)("label",{htmlFor:"base_amount",children:u.base.toUpperCase()}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"number",className:"base_amount",value:i,onChange:function(e){return o(e.target.value)}}),Object(O.jsx)("br",{}),Object(O.jsx)("label",{htmlFor:"target_amount",children:a.code}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"number",className:"target_amount",value:a.rate*i,onChange:function(e){return o(e.target.value/a.rate)}})]},a.id+"currency")}var _=n.p+"static/media/refresh.9d7fccf8.svg",k=n(18),I=n(19);function N(){var e=Object(c.useContext)(x),t=Object(c.useState)(e.cities),n=Object(S.a)(t,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){s(e.cities)}),[e]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"changeInfo",children:[Object(O.jsx)(k.a,{onClick:function(){return e.dispatch({type:"ACTIVE_TAB",payload:"weather"})}})," / ",Object(O.jsx)(I.a,{onClick:function(){return e.dispatch({type:"ACTIVE_TAB",payload:"currency"})}})]}),Object(O.jsx)("img",{className:"refresh",alt:"",src:_,onClick:function(){return window.location.reload()}}),Object(O.jsxs)("div",{id:"searchbar",children:[Object(O.jsx)("i",{className:"fas fa-search"}),Object(O.jsx)("input",{onKeyDown:function(t){"Enter"===t.key&&(e.handlefetchData(t.target.value),t.target.value="")},type:"text",id:"addCity",placeholder:"Add City",autoComplete:"off"})]})]}),a.map((function(t){return Object(O.jsxs)("div",{className:"city",id:t.id,children:[Object(O.jsxs)("h1",{onClick:function(){return e.fetchForcastAndSightseeing(t.name)},children:[t.name,", ",t.country]}),"weather"===e.active?Object(O.jsx)(w,{city:t}):Object(O.jsx)(T,{city:t}),Object(O.jsx)("img",{src:E,className:"close",alt:"close",onClick:function(){return e.dispatch({type:"DELETE",payload:t.id})}})]},t.id)}))]})}n(35),n(36);function F(){var e=function(e,t){console.log(e,t);var n=new Date(1e3*(e+t)),c=n.getUTCDate(),a=n.getUTCMonth()+1,s=n.getUTCFullYear(),r=n.getUTCHours();return"".concat(a,"/").concat(c,"/").concat(s," ").concat(r,":00")};return Object(O.jsx)(C,{children:function(t){return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{className:"forecastContainer",children:[Object(O.jsxs)("h1",{children:[t.forecast.name,", ",t.forecast.country]}),Object(O.jsxs)("table",{id:"table",children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:"Time"}),Object(O.jsx)("td",{children:"Temperature"}),Object(O.jsx)("td",{children:"Description"}),Object(O.jsx)("td",{children:"Humidity"})]})}),Object(O.jsx)("tbody",{children:t.forecast.data.map((function(n,c){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:e(n.time,n.timezone)}),"C"===t.unit?Object(O.jsxs)("td",{children:[n.temp,"\xb0C"]}):Object(O.jsxs)("td",{children:[9*n.temp/5+32,"\xb0F"]}),Object(O.jsxs)("td",{children:[Object(O.jsx)("img",{src:n.iconurl,height:"50px",alt:"icon"}),Object(O.jsx)("span",{children:n.description})]}),Object(O.jsxs)("td",{children:[Object(O.jsx)("i",{className:"fas fa-tint"}),Object(O.jsxs)("span",{children:[n.humidity,"%"]})]})]},c)}))})]})]},"forecast")})}})}n(37);var G=n(20);function A(){return Object(O.jsx)(C,{children:function(e){return Object(O.jsx)("div",{className:"sightcontainer",children:e.sightseeing.length>0?Object(O.jsx)(O.Fragment,{children:e.sightseeing.map((function(e){return Object(O.jsxs)(O.Fragment,{children:[console.log(e),Object(O.jsx)("h2",{children:e.sight}),Object(O.jsx)("img",{src:e.image,alt:e.sight,height:"100px",width:"150px"}),Object(G.a)(e.content)]})}))}):Object(O.jsx)("p",{children:"Loading..."})})}})}n(52);function D(){var e=Object(c.useContext)(x);return Object(c.useEffect)((function(){!0===e.showForecast&&(document.getElementById("F").style.borderBottom="3px solid white",document.getElementById("S").style.borderBottom="none"),!0===e.showSightseeing&&(document.getElementById("S").style.borderBottom="3px solid white",document.getElementById("F").style.borderBottom="none")}),[e.showForecast],[e.showSightseeing]),Object(O.jsxs)("div",{className:"nav",children:[Object(O.jsx)("p",{id:"F",onClick:function(){e.dispatch({type:"TOGGLE_FORECAST",payload:!0}),e.dispatch({type:"TOGGLE_SIGHTSEEING",payload:!1})},children:"Forecast"}),Object(O.jsx)("p",{id:"S",onClick:function(){e.dispatch({type:"TOGGLE_SIGHTSEEING",payload:!0}),e.dispatch({type:"TOGGLE_FORECAST",payload:!1})},children:"Sightseeing"})]})}function B(){return Object(O.jsx)(C,{children:function(e){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{className:"container",children:e.showForecast?Object(O.jsx)(F,{}):e.showSightseeing?Object(O.jsx)(A,{}):Object(O.jsx)(N,{})}),e.showForecast||e.showSightseeing?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("img",{src:E,className:"closeFS",alt:"close",onClick:function(){e.dispatch({type:"EMPTY_S"}),e.dispatch({type:"TOGGLE_SIGHTSEEING",payload:!1}),e.dispatch({type:"TOGGLE_FORECAST",payload:!1})}}),Object(O.jsx)(D,{})]}):Object(O.jsx)(O.Fragment,{})]})}})}n(53);var U=n(21),L=n(22);function M(){var e=Object(c.useContext)(x),t=Object(c.useState)(e.base),n=Object(S.a)(t,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){s(e.base)}),[e.base]),Object(c.useEffect)((function(){e.settings&&("C"===e.unit?(document.getElementById("celsius").style.color="white",document.getElementById("farenheit").style.color="black"):(document.getElementById("celsius").style.color="black",document.getElementById("farenheit").style.color="white"))}),[e.unit],[e.settings]),Object(O.jsx)("div",{className:"settings",children:e.settings?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"content",children:[Object(O.jsx)("h1",{children:"Settings"}),Object(O.jsx)("label",{htmlFor:"base_input",children:"Base Currency"}),Object(O.jsx)("input",{id:"base_input",type:"text",placeholder:"Enter Currency",value:a,onChange:function(e){return s(e.target.value)},onKeyDown:function(t){"Enter"===t.key&&(3===t.target.value.length?e.dispatch({type:"SET_BASE",payload:t.target.value}):alert("Enter a valid Currency of 3 digits"))}}),Object(O.jsxs)("p",{children:["Temperature Units: ",Object(O.jsx)("span",{id:"celsius",onClick:function(){return e.dispatch({type:"SET_UNIT",payload:"C"})},children:"C\xb0"})," / ",Object(O.jsx)("span",{id:"farenheit",onClick:function(){return e.dispatch({type:"SET_UNIT",payload:"F"})},children:"F\xb0"})]}),Object(O.jsx)("label",{htmlFor:"getval",children:"Change Background"}),Object(O.jsx)("input",{type:"file",id:"getval",name:"background-image",onChange:function(){return function(){var e=document.getElementById("getval").files[0],t=new FileReader;t.onloadend=function(){localStorage.setItem("background",t.result),document.getElementById("body").style.backgroundImage="url("+t.result+")"},e&&t.readAsDataURL(e)}()}}),Object(O.jsx)("br",{})]}),Object(O.jsx)(U.a,{className:"closeSettings",onClick:function(){return e.dispatch({type:"TOGGLE_SETTINGS",payload:!1})}})]}):Object(O.jsx)(L.a,{className:"settingsIcon",onClick:function(){return e.dispatch({type:"TOGGLE_SETTINGS",payload:!0})}})})}n(54);function H(){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(M,{}),Object(O.jsx)("footer",{children:"Gerardo Montero \xa9"})]})}var R=function(){return Object(O.jsxs)(v,{children:[Object(O.jsx)(B,{}),Object(O.jsx)(H,{})]})};r.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(R,{})}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.bc34fd3f.chunk.js.map